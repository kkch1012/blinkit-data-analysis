# ğŸ—ï¸ ë°±ì—”ë“œ êµ¬ì¡° ì„¤ê³„

## ğŸ“‹ ìš”êµ¬ì‚¬í•­ ì •ë¦¬

### í•„ìš”í•œ ì—”ë“œí¬ì¸íŠ¸
1. **ìœ ì € ê´€ë¦¬**: íšŒì›ê°€ì…, ë¡œê·¸ì¸, í”„ë¡œí•„
2. **CSV ì—…ë¡œë“œ**: íŒŒì¼ ì—…ë¡œë“œ ë° ì €ì¥
3. **ì‹œê°í™”/í†µê³„**: CSV ë°ì´í„° ê¸°ë°˜ ì‹œê°í™” ë° í†µê³„
4. **ìƒê´€ê´€ê³„ ë¶„ì„**: ë³€ìˆ˜ ê°„ ìƒê´€ê´€ê³„ ë¶„ì„ ë° ì‹œê°í™”
5. **ì˜ˆì¸¡ ëª¨ë¸**: í”¼ì²˜ ê°€ì¤‘ì¹˜ ê¸°ë°˜ ìˆ˜ëŸ‰/ê¸ˆì•¡ ì˜ˆì¸¡
6. **LLM ì†”ë£¨ì…˜**: ëª¨ë“  ë¶„ì„ ê²°ê³¼ë¥¼ LLMì— ì „ë‹¬í•˜ì—¬ ì†”ë£¨ì…˜ ìƒì„±

---

## ğŸ—‚ï¸ ë””ë ‰í† ë¦¬ êµ¬ì¡°

```
backend/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ __init__.py                 # Flask ì•± ì´ˆê¸°í™”
â”‚   â”œâ”€â”€ config.py                   # ì„¤ì • íŒŒì¼
â”‚   â”œâ”€â”€ models/                     # ë°ì´í„° ëª¨ë¸
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ user.py                 # ìœ ì € ëª¨ë¸
â”‚   â”‚   â””â”€â”€ file.py                  # íŒŒì¼ ëª¨ë¸
â”‚   â”œâ”€â”€ services/                   # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ user_service.py         # ìœ ì € ì„œë¹„ìŠ¤
â”‚   â”‚   â”œâ”€â”€ file_service.py         # íŒŒì¼ ì„œë¹„ìŠ¤
â”‚   â”‚   â”œâ”€â”€ visualization_service.py # ì‹œê°í™” ì„œë¹„ìŠ¤
â”‚   â”‚   â”œâ”€â”€ correlation_service.py  # ìƒê´€ê´€ê³„ ë¶„ì„ ì„œë¹„ìŠ¤
â”‚   â”‚   â”œâ”€â”€ prediction_service.py   # ì˜ˆì¸¡ ì„œë¹„ìŠ¤
â”‚   â”‚   â””â”€â”€ llm_service.py          # LLM ì„œë¹„ìŠ¤
â”‚   â”œâ”€â”€ api/                        # API ì—”ë“œí¬ì¸íŠ¸
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ auth.py                 # ì¸ì¦ ê´€ë ¨
â”‚   â”‚   â”œâ”€â”€ users.py                # ìœ ì € ê´€ë ¨
â”‚   â”‚   â”œâ”€â”€ files.py                # íŒŒì¼ ê´€ë ¨
â”‚   â”‚   â”œâ”€â”€ visualizations.py       # ì‹œê°í™” ê´€ë ¨
â”‚   â”‚   â”œâ”€â”€ correlations.py          # ìƒê´€ê´€ê³„ ê´€ë ¨
â”‚   â”‚   â”œâ”€â”€ predictions.py          # ì˜ˆì¸¡ ê´€ë ¨
â”‚   â”‚   â””â”€â”€ solutions.py            # LLM ì†”ë£¨ì…˜ ê´€ë ¨
â”‚   â”œâ”€â”€ utils/                      # ìœ í‹¸ë¦¬í‹°
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ mongo_utils.py          # MongoDB ìœ í‹¸
â”‚   â”‚   â”œâ”€â”€ validators.py           # ë°ì´í„° ê²€ì¦
â”‚   â”‚   â””â”€â”€ helpers.py              # í—¬í¼ í•¨ìˆ˜
â”‚   â””â”€â”€ middleware/                 # ë¯¸ë“¤ì›¨ì–´
â”‚       â”œâ”€â”€ __init__.py
â”‚       â””â”€â”€ auth_middleware.py      # ì¸ì¦ ë¯¸ë“¤ì›¨ì–´
â”œâ”€â”€ requirements.txt                 # ì˜ì¡´ì„±
â”œâ”€â”€ .env                            # í™˜ê²½ë³€ìˆ˜
â””â”€â”€ run.py                          # ì‹¤í–‰ íŒŒì¼
```

---

## ğŸ”Œ API ì—”ë“œí¬ì¸íŠ¸ ì„¤ê³„

### 1. ì¸ì¦ (Auth)

#### POST `/api/auth/register`
íšŒì›ê°€ì…

**Request:**
```json
{
  "email": "user@example.com",
  "password": "password123",
  "name": "í™ê¸¸ë™"
}
```

**Response:**
```json
{
  "success": true,
  "user_id": "user_123",
  "token": "jwt_token..."
}
```

#### POST `/api/auth/login`
ë¡œê·¸ì¸

**Request:**
```json
{
  "email": "user@example.com",
  "password": "password123"
}
```

**Response:**
```json
{
  "success": true,
  "user_id": "user_123",
  "token": "jwt_token..."
}
```

---

### 2. íŒŒì¼ ê´€ë¦¬ (Files)

#### POST `/api/files/upload`
CSV íŒŒì¼ ì—…ë¡œë“œ

**Request:**
```
Content-Type: multipart/form-data
file: [CSV íŒŒì¼]
```

**Response:**
```json
{
  "success": true,
  "file_id": "file_001",
  "file_name": "sales_data.csv",
  "columns": ["ë‚ ì§œ", "ìƒí’ˆëª…", "ìˆ˜ëŸ‰", "ê¸ˆì•¡"],
  "row_count": 5000
}
```

#### GET `/api/files`
ì‚¬ìš©ìì˜ íŒŒì¼ ëª©ë¡

**Response:**
```json
{
  "success": true,
  "files": [
    {
      "file_id": "file_001",
      "file_name": "sales_data.csv",
      "uploaded_at": "2024-12-29T12:00:00Z",
      "row_count": 5000
    }
  ]
}
```

#### GET `/api/files/<file_id>`
íŒŒì¼ ìƒì„¸ ì •ë³´

**Response:**
```json
{
  "success": true,
  "file_id": "file_001",
  "file_name": "sales_data.csv",
  "columns": ["ë‚ ì§œ", "ìƒí’ˆëª…", "ìˆ˜ëŸ‰", "ê¸ˆì•¡"],
  "column_types": {...},
  "row_count": 5000
}
```

---

### 3. ì‹œê°í™” ë° í†µê³„ (Visualizations)

#### POST `/api/visualizations/statistics`
í†µê³„ ë° ì‹œê°í™” ìƒì„±

**Request:**
```json
{
  "file_id": "file_001",
  "options": {
    "include_charts": true,
    "chart_types": ["bar", "line", "pie"]
  }
}
```

**Response:**
```json
{
  "success": true,
  "statistics": {
    "total_rows": 5000,
    "numeric_summary": {
      "ìˆ˜ëŸ‰": {"mean": 10.5, "std": 2.3, "min": 1, "max": 50},
      "ê¸ˆì•¡": {"mean": 15000, "std": 5000, "min": 1000, "max": 100000}
    },
    "categorical_summary": {
      "ìƒí’ˆëª…": {"unique_count": 100, "top_values": [...]}
    }
  },
  "charts": {
    "distribution": "base64_image...",
    "trend": "base64_image...",
    "category_distribution": "base64_image..."
  }
}
```

#### GET `/api/visualizations/<file_id>`
ì €ì¥ëœ ì‹œê°í™” ì¡°íšŒ

---

### 4. ìƒê´€ê´€ê³„ ë¶„ì„ (Correlations)

#### POST `/api/correlations/analyze`
ìƒê´€ê´€ê³„ ë¶„ì„ ë° ì‹œê°í™”

**Request:**
```json
{
  "file_id": "file_001",
  "target_column": "ìˆ˜ëŸ‰",
  "features": ["ê¸ˆì•¡", "í‰ì ", "temp_max", "rainfall"]
}
```

**Response:**
```json
{
  "success": true,
  "correlation_matrix": {
    "ìˆ˜ëŸ‰": {
      "ê¸ˆì•¡": 0.85,
      "í‰ì ": 0.32,
      "temp_max": 0.15,
      "rainfall": 0.08
    }
  },
  "top_correlations": [
    {"feature": "ê¸ˆì•¡", "correlation": 0.85},
    {"feature": "í‰ì ", "correlation": 0.32}
  ],
  "chart": "base64_image...",
  "weights": {
    "ê¸ˆì•¡": 0.45,
    "í‰ì ": 0.20,
    "temp_max": 0.15,
    "rainfall": 0.10
  }
}
```

#### GET `/api/correlations/<file_id>`
ì €ì¥ëœ ìƒê´€ê´€ê³„ ë¶„ì„ ê²°ê³¼ ì¡°íšŒ

---

### 5. ì˜ˆì¸¡ (Predictions)

#### POST `/api/predictions/forecast`
ìˆ˜ëŸ‰ ë° ê¸ˆì•¡ ì˜ˆì¸¡

**Request:**
```json
{
  "file_id": "file_001",
  "target_columns": ["ìˆ˜ëŸ‰", "ê¸ˆì•¡"],
  "forecast_days": 7,
  "weights": {
    "ê¸ˆì•¡": 0.45,
    "í‰ì ": 0.20,
    "temp_max": 0.15
  }
}
```

**Response:**
```json
{
  "success": true,
  "predictions": {
    "quantity": {
      "dates": ["2024-12-30", "2024-12-31", ...],
      "predicted": [10.5, 12.3, ...],
      "avg": 10.5,
      "confidence_interval": {"lower": 8.5, "upper": 12.5}
    },
    "amount": {
      "dates": ["2024-12-30", "2024-12-31", ...],
      "predicted": [15000, 18000, ...],
      "avg": 15000,
      "confidence_interval": {"lower": 12000, "upper": 18000}
    }
  },
  "metrics": {
    "quantity": {"mae": 1.23, "r2": 0.65, "accuracy": 72.5},
    "amount": {"mae": 500.5, "r2": 0.70, "accuracy": 75.0}
  },
  "chart": "base64_image..."
}
```

#### GET `/api/predictions/<file_id>`
ì €ì¥ëœ ì˜ˆì¸¡ ê²°ê³¼ ì¡°íšŒ

---

### 6. LLM ì†”ë£¨ì…˜ (Solutions)

#### POST `/api/solutions/generate`
ëª¨ë“  ë¶„ì„ ê²°ê³¼ë¥¼ LLMì— ì „ë‹¬í•˜ì—¬ ì†”ë£¨ì…˜ ìƒì„±

**Request:**
```json
{
  "file_id": "file_001",
  "include_visualizations": true,
  "include_correlations": true,
  "include_predictions": true
}
```

**Response:**
```json
{
  "success": true,
  "solution": {
    "summary": "ë¶„ì„ ê²°ê³¼ ìš”ì•½...",
    "insights": [
      "ìˆ˜ëŸ‰ê³¼ ê¸ˆì•¡ ê°„ ê°•í•œ ì–‘ì˜ ìƒê´€ê´€ê³„(0.85) ë°œê²¬",
      "ê¸°ì˜¨ì´ ë†’ì„ìˆ˜ë¡ íŒë§¤ëŸ‰ ì¦ê°€ ê²½í–¥",
      "ì£¼ë§ íŒë§¤ëŸ‰ì´ í‰ì¼ ëŒ€ë¹„ 15% ë†’ìŒ"
    ],
    "recommendations": [
      "ì¬ê³ ëŠ” í‰ê·  ìˆ˜ëŸ‰ì˜ 1.2ë°° ì¤€ë¹„ ê¶Œì¥",
      "ì£¼ë§ ì¬ê³  ì¦ê°€ í•„ìš”",
      "ê¸°ì˜¨ì´ ë†’ì€ ë‚  ë§ˆì¼€íŒ… ê°•í™”"
    ],
    "action_items": [
      {"priority": "high", "action": "ì£¼ë§ ì¬ê³  20% ì¦ê°€", "reason": "..."},
      {"priority": "medium", "action": "ê¸°ì˜¨ ê¸°ë°˜ ë™ì  ê°€ê²© ì¡°ì •", "reason": "..."}
    ]
  }
}
```

#### GET `/api/solutions/<file_id>`
ì €ì¥ëœ ì†”ë£¨ì…˜ ì¡°íšŒ

---

## ğŸ—ï¸ ì„œë¹„ìŠ¤ ë ˆì´ì–´ êµ¬ì¡°

### ì„œë¹„ìŠ¤ í´ë˜ìŠ¤ êµ¬ì¡°

```python
# services/base_service.py
class BaseService:
    """ëª¨ë“  ì„œë¹„ìŠ¤ì˜ ê¸°ë³¸ í´ë˜ìŠ¤"""
    def __init__(self):
        self.mongo = MongoDBService()
    
    def validate_file_exists(self, file_id: str):
        """íŒŒì¼ ì¡´ì¬ ì—¬ë¶€ í™•ì¸"""
        pass

# services/visualization_service.py
class VisualizationService(BaseService):
    def generate_statistics(self, file_id: str) -> dict:
        """í†µê³„ ìƒì„±"""
        pass
    
    def create_charts(self, file_id: str, chart_types: list) -> dict:
        """ì°¨íŠ¸ ìƒì„±"""
        pass

# services/correlation_service.py
class CorrelationService(BaseService):
    def analyze_correlations(self, file_id: str, target: str, features: list) -> dict:
        """ìƒê´€ê´€ê³„ ë¶„ì„"""
        pass
    
    def calculate_weights(self, correlations: dict) -> dict:
        """ê°€ì¤‘ì¹˜ ê³„ì‚°"""
        pass

# services/prediction_service.py
class PredictionService(BaseService):
    def forecast(self, file_id: str, targets: list, weights: dict, days: int) -> dict:
        """ì˜ˆì¸¡ ì‹¤í–‰"""
        pass

# services/llm_service.py
class LLMService(BaseService):
    def generate_solution(self, file_id: str, include_all: bool) -> dict:
        """LLM ì†”ë£¨ì…˜ ìƒì„±"""
        # ëª¨ë“  ë¶„ì„ ê²°ê³¼ ìˆ˜ì§‘
        # LLMì— ì „ë‹¬
        # ì†”ë£¨ì…˜ ìƒì„±
        pass
```

---

## ğŸ“Š ë°ì´í„° íë¦„

```
[1] CSV ì—…ë¡œë“œ
    POST /api/files/upload
    â†“
    MongoDB ì €ì¥ (files, csv_contents)
    
[2] í†µê³„ ë° ì‹œê°í™”
    POST /api/visualizations/statistics
    â†“
    í†µê³„ ê³„ì‚° + ì°¨íŠ¸ ìƒì„±
    â†“
    MongoDB ì €ì¥ (visualizations)
    
[3] ìƒê´€ê´€ê³„ ë¶„ì„
    POST /api/correlations/analyze
    â†“
    ìƒê´€ê³„ìˆ˜ ê³„ì‚° + ê°€ì¤‘ì¹˜ ìƒì„±
    â†“
    MongoDB ì €ì¥ (correlations)
    
[4] ì˜ˆì¸¡
    POST /api/predictions/forecast
    â†“
    í”¼ì²˜ ê°€ì¤‘ì¹˜ ê¸°ë°˜ ëª¨ë¸ í•™ìŠµ
    â†“
    ìˆ˜ëŸ‰/ê¸ˆì•¡ ì˜ˆì¸¡
    â†“
    MongoDB ì €ì¥ (predictions)
    
[5] LLM ì†”ë£¨ì…˜
    POST /api/solutions/generate
    â†“
    ëª¨ë“  ë¶„ì„ ê²°ê³¼ ìˆ˜ì§‘
    â†“
    LLMì— ì „ë‹¬
    â†“
    ì†”ë£¨ì…˜ ìƒì„±
    â†“
    MongoDB ì €ì¥ (solutions)
```

---

## ğŸ” ì¸ì¦ êµ¬ì¡°

### JWT ê¸°ë°˜ ì¸ì¦

```python
# middleware/auth_middleware.py
from functools import wraps
from flask import request, jsonify
import jwt

def token_required(f):
    @wraps(f)
    def decorated(*args, **kwargs):
        token = request.headers.get('Authorization')
        if not token:
            return jsonify({'error': 'í† í°ì´ í•„ìš”í•©ë‹ˆë‹¤'}), 401
        
        try:
            # JWT ê²€ì¦
            data = jwt.decode(token, SECRET_KEY, algorithms=['HS256'])
            current_user_id = data['user_id']
        except:
            return jsonify({'error': 'ìœ íš¨í•˜ì§€ ì•Šì€ í† í°'}), 401
        
        return f(current_user_id, *args, **kwargs)
    return decorated
```

### ì‚¬ìš© ì˜ˆì‹œ

```python
@app.route('/api/files/upload', methods=['POST'])
@token_required
def upload_file(current_user_id):
    # current_user_id ì‚¬ìš©
    pass
```

---

## ğŸ—„ï¸ MongoDB ì»¬ë ‰ì…˜ êµ¬ì¡°

### ì¶”ê°€ ì»¬ë ‰ì…˜

#### `users` ì»¬ë ‰ì…˜
```json
{
  "_id": ObjectId("..."),
  "user_id": "user_123",
  "email": "user@example.com",
  "password_hash": "...",
  "name": "í™ê¸¸ë™",
  "created_at": ISODate("...")
}
```

#### `correlations` ì»¬ë ‰ì…˜
```json
{
  "_id": ObjectId("..."),
  "correlation_id": "corr_001",
  "file_id": "file_001",
  "user_id": "user_123",
  "target_column": "ìˆ˜ëŸ‰",
  "correlation_matrix": {...},
  "weights": {...},
  "chart": "base64_image...",
  "created_at": ISODate("...")
}
```

#### `solutions` ì»¬ë ‰ì…˜
```json
{
  "_id": ObjectId("..."),
  "solution_id": "sol_001",
  "file_id": "file_001",
  "user_id": "user_123",
  "solution": {
    "summary": "...",
    "insights": [...],
    "recommendations": [...],
    "action_items": [...]
  },
  "created_at": ISODate("...")
}
```

---

## ğŸ“ êµ¬í˜„ ì˜ˆì‹œ

### API ì—”ë“œí¬ì¸íŠ¸ ì˜ˆì‹œ

```python
# api/correlations.py
from flask import Blueprint, request, jsonify
from services.correlation_service import CorrelationService
from middleware.auth_middleware import token_required

correlations_bp = Blueprint('correlations', __name__)
correlation_service = CorrelationService()

@correlations_bp.route('/analyze', methods=['POST'])
@token_required
def analyze_correlations(current_user_id):
    data = request.json
    file_id = data.get('file_id')
    target_column = data.get('target_column')
    features = data.get('features', [])
    
    result = correlation_service.analyze_correlations(
        file_id, target_column, features
    )
    
    return jsonify({
        'success': True,
        **result
    }), 200
```

---

## ğŸš€ ì‹¤í–‰ êµ¬ì¡°

### run.py
```python
from app import create_app

app = create_app()

if __name__ == '__main__':
    app.run(debug=True, port=5000, host='0.0.0.0')
```

### app/__init__.py
```python
from flask import Flask
from flask_cors import CORS

def create_app():
    app = Flask(__name__)
    CORS(app)
    
    # Blueprint ë“±ë¡
    from app.api import auth, files, visualizations, correlations, predictions, solutions
    
    app.register_blueprint(auth.bp, url_prefix='/api/auth')
    app.register_blueprint(files.bp, url_prefix='/api/files')
    app.register_blueprint(visualizations.bp, url_prefix='/api/visualizations')
    app.register_blueprint(correlations.bp, url_prefix='/api/correlations')
    app.register_blueprint(predictions.bp, url_prefix='/api/predictions')
    app.register_blueprint(solutions.bp, url_prefix='/api/solutions')
    
    return app
```

---

## ğŸ“¦ ì˜ì¡´ì„± ê´€ë¦¬

### requirements.txt
```
Flask==3.0.0
Flask-CORS==4.0.0
pymongo==4.6.0
pandas==2.1.0
numpy==1.24.0
scikit-learn==1.3.0
plotly==5.18.0
kaleido==0.2.1
openai==1.3.0
python-dotenv==1.0.0
PyJWT==2.8.0
bcrypt==4.1.0
```

---

## ğŸ”„ ì „ì²´ í”Œë¡œìš° ì˜ˆì‹œ

### ì‚¬ìš©ì ì‹œë‚˜ë¦¬ì˜¤

```
[1] íšŒì›ê°€ì…
    POST /api/auth/register
    â†’ user_id, token ë°›ìŒ

[2] CSV ì—…ë¡œë“œ
    POST /api/files/upload
    â†’ file_id ë°›ìŒ

[3] í†µê³„ ë° ì‹œê°í™”
    POST /api/visualizations/statistics
    â†’ í†µê³„ + ì°¨íŠ¸ ë°›ìŒ

[4] ìƒê´€ê´€ê³„ ë¶„ì„
    POST /api/correlations/analyze
    â†’ ìƒê´€ê³„ìˆ˜ + ê°€ì¤‘ì¹˜ ë°›ìŒ

[5] ì˜ˆì¸¡
    POST /api/predictions/forecast
    â†’ ìˆ˜ëŸ‰/ê¸ˆì•¡ ì˜ˆì¸¡ ë°›ìŒ

[6] LLM ì†”ë£¨ì…˜
    POST /api/solutions/generate
    â†’ ì¢…í•© ì†”ë£¨ì…˜ ë°›ìŒ
```

---

## âœ… ì¥ì 

1. **ëª¨ë“ˆí™”**: ê° ê¸°ëŠ¥ì´ ë…ë¦½ì ì¸ ì„œë¹„ìŠ¤ë¡œ ë¶„ë¦¬
2. **í™•ì¥ì„±**: ìƒˆë¡œìš´ ê¸°ëŠ¥ ì¶”ê°€ê°€ ì‰¬ì›€
3. **ìœ ì§€ë³´ìˆ˜**: ì½”ë“œ êµ¬ì¡°ê°€ ëª…í™•í•¨
4. **í…ŒìŠ¤íŠ¸**: ê° ì„œë¹„ìŠ¤ë¥¼ ë…ë¦½ì ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥
5. **ì¬ì‚¬ìš©ì„±**: ì„œë¹„ìŠ¤ë¥¼ ë‹¤ë¥¸ í”„ë¡œì íŠ¸ì—ì„œë„ ì‚¬ìš© ê°€ëŠ¥

---

*ë¬¸ì„œ ì‘ì„±ì¼: 2024-12-29*

