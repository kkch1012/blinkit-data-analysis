# ğŸ“Š MongoDB ìŠ¤í‚¤ë§ˆ ì„¤ê³„ ë¬¸ì„œ

## ğŸ¯ ëª©í‘œ
ì›¹ ì„œë¹„ìŠ¤ì—ì„œ CSV íŒŒì¼ì„ ì—…ë¡œë“œí•˜ê³ , ìë™ìœ¼ë¡œ ë¶„ì„í•˜ì—¬ í”¼ì²˜ ê°€ì¤‘ì¹˜ë¥¼ ìƒì„±í•˜ëŠ” ì‹œìŠ¤í…œì˜ ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡° ì„¤ê³„

---

## ğŸ“Œ MongoDB ê¸°ë³¸ ê°œë…

### ObjectIdë€?

**ObjectId**ëŠ” MongoDBê°€ ê° ë¬¸ì„œ(document)ì— ìë™ìœ¼ë¡œ ë¶€ì—¬í•˜ëŠ” **ê³ ìœ  ì‹ë³„ì**ì…ë‹ˆë‹¤.

#### íŠ¹ì§•:
- âœ… **ìë™ ìƒì„±**: ë¬¸ì„œë¥¼ ì €ì¥í•  ë•Œ MongoDBê°€ ìë™ìœ¼ë¡œ ìƒì„±
- âœ… **ê³ ìœ ì„± ë³´ì¥**: ì „ ì„¸ê³„ì ìœ¼ë¡œ ì¤‘ë³µë˜ì§€ ì•ŠëŠ” ê³ ìœ í•œ ê°’
- âœ… **12ë°”ì´íŠ¸ í¬ê¸°**: 24ìë¦¬ 16ì§„ìˆ˜ ë¬¸ìì—´ë¡œ í‘œí˜„
- âœ… **íƒ€ì„ìŠ¤íƒ¬í”„ í¬í•¨**: ìƒì„± ì‹œê°„ ì •ë³´ê°€ ë‚´ì¥ë˜ì–´ ìˆìŒ

#### êµ¬ì¡°:
```
ObjectId = 4ë°”ì´íŠ¸(íƒ€ì„ìŠ¤íƒ¬í”„) + 5ë°”ì´íŠ¸(ëœë¤ê°’) + 3ë°”ì´íŠ¸(ì¹´ìš´í„°)
ì˜ˆ: ObjectId("507f1f77bcf86cd799439011")
```

#### ì˜ˆì‹œ:
```javascript
// MongoDBì— ë¬¸ì„œ ì €ì¥ ì‹œ
db.files.insertOne({
  "file_id": "file_001",
  "user_id": "user123"
})

// ìë™ìœ¼ë¡œ _idê°€ ìƒì„±ë¨
{
  "_id": ObjectId("507f1f77bcf86cd799439011"),  // â† ìë™ ìƒì„±!
  "file_id": "file_001",
  "user_id": "user123"
}
```

#### ì¸ë±ìŠ¤ ë²ˆí˜¸ì™€ì˜ ì°¨ì´:

| êµ¬ë¶„ | ì¸ë±ìŠ¤ ë²ˆí˜¸ (SQL) | ObjectId (MongoDB) |
|------|------------------|-------------------|
| **íƒ€ì…** | ìˆ«ì (1, 2, 3...) | 24ìë¦¬ 16ì§„ìˆ˜ ë¬¸ìì—´ |
| **ìƒì„±** | ìë™ ì¦ê°€ (AUTO_INCREMENT) | ìë™ ìƒì„± (íƒ€ì„ìŠ¤íƒ¬í”„ ê¸°ë°˜) |
| **ê³ ìœ ì„±** | í…Œì´ë¸” ë‚´ì—ì„œë§Œ ê³ ìœ  | ì „ ì„¸ê³„ì ìœ¼ë¡œ ê³ ìœ  |
| **ìˆœì„œ** | ìˆœì°¨ì  (1, 2, 3...) | ì‹œê°„ ê¸°ë°˜ (ìµœì‹  ê²ƒì´ ë” í° ê°’) |
| **ìš©ë„** | ì£¼ë¡œ ë‚´ë¶€ ì‹ë³„ìš© | ë¬¸ì„œ ì‹ë³„ ë° ì¡°íšŒìš© |

#### ì‹¤ì œ ì‚¬ìš© ì˜ˆì‹œ:

```javascript
// 1. ObjectIdë¡œ ë¬¸ì„œ ì¡°íšŒ
db.files.findOne({ "_id": ObjectId("507f1f77bcf86cd799439011") })

// 2. ObjectId ì—†ì´ë„ ì¡°íšŒ ê°€ëŠ¥ (file_id ì‚¬ìš©)
db.files.findOne({ "file_id": "file_001" })

// 3. ObjectIdëŠ” ìë™ ìƒì„±ë˜ë¯€ë¡œ ë³´í†µì€ ë¬´ì‹œí•´ë„ ë¨
//    ìš°ë¦¬ê°€ ë§Œë“  file_idë¥¼ ì£¼ë¡œ ì‚¬ìš©!
```

**ğŸ’¡ í•µì‹¬**: 
- `_id` (ObjectId)ëŠ” MongoDBê°€ ìë™ìœ¼ë¡œ ë§Œë“œëŠ” **ë‚´ë¶€ ì‹ë³„ì**
- ìš°ë¦¬ê°€ ë§Œë“  `file_id`, `user_id` ë“±ì€ **ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ìš© ì‹ë³„ì**
- ë³´í†µì€ `file_id`ë¡œ ì¡°íšŒí•˜ê³ , `_id`ëŠ” MongoDBê°€ ì•Œì•„ì„œ ê´€ë¦¬

---

## ğŸ“‹ ì „ì²´ ì‹œìŠ¤í…œ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ì›¹ ì„œë¹„ìŠ¤ í”Œë¡œìš°                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[1ë‹¨ê³„] ì‚¬ìš©ì CSV ì—…ë¡œë“œ
    â”‚
    â”œâ”€ ë¸Œë¼ìš°ì €ì—ì„œ CSV íŒŒì¼ ì„ íƒ
    â”œâ”€ ì„œë²„ë¡œ ì „ì†¡ (POST /api/upload)
    â”‚
    â–¼
[2ë‹¨ê³„] íŒŒì¼ íŒŒì‹± ë° ì €ì¥
    â”‚
    â”œâ”€ CSV íŒŒì‹± (pandas)
    â”œâ”€ ì»¬ëŸ¼ ì •ë³´ ì¶”ì¶œ
    â”œâ”€ MongoDBì— ì €ì¥
    â”‚   â”œâ”€ files ì»¬ë ‰ì…˜: ë©”íƒ€ë°ì´í„°
    â”‚   â””â”€ csv_contents ì»¬ë ‰ì…˜: ì‹¤ì œ ë°ì´í„°
    â”‚
    â–¼
[3ë‹¨ê³„] ìë™ ë¶„ì„ ë° ì œì•ˆ ìƒì„±
    â”‚
    â”œâ”€ ì»¬ëŸ¼ íƒ€ì… ê°ì§€ (ë‚ ì§œ, ë²”ì£¼í˜•, ìˆ˜ì¹˜í˜•)
    â”œâ”€ í‚¤ì›Œë“œ ë§¤ì¹­ (ê¸ˆì•¡, ìˆ˜ëŸ‰, ë‚ ì§œ ë“±)
    â”œâ”€ ì œì•ˆ ìƒì„±
    â”‚   â””â”€ user_suggestions ì»¬ë ‰ì…˜ì— ì €ì¥
    â”‚
    â–¼
[4ë‹¨ê³„] ì‚¬ìš©ìê°€ "ë¶„ì„ ì‹œì‘" í´ë¦­
    â”‚
    â”œâ”€ ìë™í™” íŒŒì´í”„ë¼ì¸ ì‹¤í–‰
    â”‚   â”œâ”€ í”¼ì²˜ ì—”ì§€ë‹ˆì–´ë§
    â”‚   â”œâ”€ ê°€ì¤‘ì¹˜ ê³„ì‚°
    â”‚   â””â”€ ëª¨ë¸ í•™ìŠµ
    â”‚
    â–¼
[5ë‹¨ê³„] ê²°ê³¼ ì €ì¥
    â”‚
    â”œâ”€ analysis_results ì»¬ë ‰ì…˜: ë¶„ì„ ê²°ê³¼
    â””â”€ feature_weights ì»¬ë ‰ì…˜: í”¼ì²˜ ê°€ì¤‘ì¹˜
```

---

## ğŸ—„ï¸ ì»¬ë ‰ì…˜(í…Œì´ë¸”) ì„¤ê³„

### 1ï¸âƒ£ `files` ì»¬ë ‰ì…˜ (íŒŒì¼ ë©”íƒ€ë°ì´í„°)

**ëª©ì **: ì–´ë–¤ ìœ ì €ê°€ ì–´ë–¤ íŒŒì¼ì„ ì˜¬ë ¸ëŠ”ì§€, íŒŒì¼ì˜ ê¸°ë³¸ ì •ë³´ ì €ì¥

**ìŠ¤í‚¤ë§ˆ**:
```json
{
  "_id": ObjectId("..."),                    // MongoDB ìë™ ìƒì„±
  "file_id": "file_20241229120000_user123",  // ê³ ìœ  íŒŒì¼ ID
  "user_id": "user123",                       // ì‚¬ìš©ì ID
  "file_name": "blinkit_sales_data.csv",     // ì›ë³¸ íŒŒì¼ëª…
  "file_size": 1024000,                      // íŒŒì¼ í¬ê¸° (bytes)
  "columns": [                                // ì»¬ëŸ¼ ëª©ë¡
    "ì£¼ë¬¸ë‚ ì§œ",
    "ìƒí’ˆëª…",
    "ì¹´í…Œê³ ë¦¬",
    "ìˆ˜ëŸ‰",
    "ê¸ˆì•¡",
    "ì§€ì—­"
  ],
  "column_types": {                           // ê° ì»¬ëŸ¼ì˜ ë°ì´í„° íƒ€ì…
    "ì£¼ë¬¸ë‚ ì§œ": "object",
    "ìƒí’ˆëª…": "object",
    "ì¹´í…Œê³ ë¦¬": "object",
    "ìˆ˜ëŸ‰": "int64",
    "ê¸ˆì•¡": "float64",
    "ì§€ì—­": "object"
  },
  "row_count": 5000,                         // ì´ í–‰ ìˆ˜
  "uploaded_at": ISODate("2024-12-29T12:00:00Z"),  // ì—…ë¡œë“œ ì‹œê°„
  "status": "uploaded"                        // ìƒíƒœ: uploaded, analyzing, completed, error
}
```

**ì¸ë±ìŠ¤**:
```javascript
// ì‚¬ìš©ìë³„ íŒŒì¼ ì¡°íšŒ ìµœì í™”
db.files.createIndex({ "user_id": 1, "uploaded_at": -1 })

// íŒŒì¼ IDë¡œ ë¹ ë¥¸ ì¡°íšŒ
db.files.createIndex({ "file_id": 1 })
```

**ì‚¬ìš© ì˜ˆì‹œ**:
- "user123ì´ ì˜¬ë¦° íŒŒì¼ ëª©ë¡ ë³´ê¸°"
- "file_xxx íŒŒì¼ì˜ ì»¬ëŸ¼ ì •ë³´ í™•ì¸"
- "ì–´ë–¤ íŒŒì¼ì´ ë¶„ì„ ì¤‘ì¸ì§€ í™•ì¸"

---

### 2ï¸âƒ£ `csv_contents` ì»¬ë ‰ì…˜ (ì‹¤ì œ CSV ë°ì´í„°)

**ëª©ì **: CSVì˜ ì‹¤ì œ ë°ì´í„°ë¥¼ ì €ì¥ (ëŒ€ëŸ‰ ë°ì´í„°)

**ìŠ¤í‚¤ë§ˆ**:
```json
{
  "_id": ObjectId("..."),
  "file_id": "file_20241229120000_user123",  // ì–´ë–¤ íŒŒì¼ì˜ ë°ì´í„°ì¸ì§€
  "user_id": "user123",                       // ì–´ë–¤ ì‚¬ìš©ìì˜ ë°ì´í„°ì¸ì§€
  "row_index": 0,                            // ì›ë³¸ CSVì˜ í–‰ ë²ˆí˜¸ (0ë¶€í„° ì‹œì‘)
  "data": {                                  // ì‹¤ì œ ë°ì´í„° (JSON í˜•íƒœ)
    "ì£¼ë¬¸ë‚ ì§œ": "2024-07-17",
    "ìƒí’ˆëª…": "Pet Treats",
    "ì¹´í…Œê³ ë¦¬": "Pet Care",
    "ìˆ˜ëŸ‰": 3,
    "ê¸ˆì•¡": 1551.09,
    "ì§€ì—­": "Allahabad"
  },
  "created_at": ISODate("2024-12-29T12:00:00Z")
}
```

**ì¸ë±ìŠ¤**:
```javascript
// íŒŒì¼ë³„ ë°ì´í„° ì¡°íšŒ (row_index ìˆœì„œëŒ€ë¡œ)
db.csv_contents.createIndex({ "file_id": 1, "row_index": 1 })

// ì‚¬ìš©ìë³„ ë°ì´í„° ì¡°íšŒ
db.csv_contents.createIndex({ "user_id": 1 })
```

**ì‚¬ìš© ì˜ˆì‹œ**:
- "file_xxx íŒŒì¼ì˜ ì²« 100ê°œ í–‰ ë³´ê¸°"
- "íŠ¹ì • íŒŒì¼ì˜ ëª¨ë“  ë°ì´í„° ì¡°íšŒ"
- "ë°ì´í„° í•„í„°ë§ (ì˜ˆ: ìˆ˜ëŸ‰ > 10)"

**ì£¼ì˜ì‚¬í•­**:
- ëŒ€ëŸ‰ ë°ì´í„°ì´ë¯€ë¡œ ë°°ì¹˜ ì‚½ì… ê¶Œì¥ (1000ê°œì”©)
- í•„ìš”ì‹œ ìƒ¤ë”© ê³ ë ¤

---

### 3ï¸âƒ£ `user_suggestions` ì»¬ë ‰ì…˜ (ìë™ ì œì•ˆ)

**ëª©ì **: íŒŒì¼ ì—…ë¡œë“œ ì‹œ ìë™ìœ¼ë¡œ ìƒì„±ë˜ëŠ” ì œì•ˆ ë©”ì‹œì§€ ì €ì¥

**ìŠ¤í‚¤ë§ˆ**:
```json
{
  "_id": ObjectId("..."),
  "file_id": "file_20241229120000_user123",
  "user_id": "user123",
  "suggestions": [                            // ì œì•ˆ ë©”ì‹œì§€ ë¦¬ìŠ¤íŠ¸
    "ğŸ’° 'ê¸ˆì•¡' ì»¬ëŸ¼ì´ ìˆë„¤ìš”! í•©ê³„/í‰ê· ì„ êµ¬í•´ë“œë¦´ê¹Œìš”?",
    "ğŸ“¦ 'ìˆ˜ëŸ‰' ì»¬ëŸ¼ì´ ìˆë„¤ìš”! ì´ íŒë§¤ëŸ‰ì„ ê³„ì‚°í•´ë“œë¦´ê¹Œìš”?",
    "ğŸ“… ë‚ ì§œ ì»¬ëŸ¼ì´ ìˆë„¤ìš”! ì‹œê³„ì—´ ë¶„ì„ì„ ì§„í–‰í• ê¹Œìš”?",
    "ğŸ“ˆ ì£¼ê°„/ì›”ê°„ íŠ¸ë Œë“œ ë¶„ì„ì„ í•´ë“œë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤!",
    "ğŸ·ï¸ ë²”ì£¼í˜• ì»¬ëŸ¼(ìƒí’ˆëª…, ì¹´í…Œê³ ë¦¬)ì´ ìˆë„¤ìš”! ê·¸ë£¹ë³„ ì§‘ê³„ë¥¼ í• ê¹Œìš”?"
  ],
  "detected_features": {                       // ê°ì§€ëœ íŠ¹ì§•
    "has_amount_column": true,
    "has_quantity_column": true,
    "has_date_column": true,
    "categorical_columns": ["ìƒí’ˆëª…", "ì¹´í…Œê³ ë¦¬", "ì§€ì—­"]
  },
  "created_at": ISODate("2024-12-29T12:00:00Z")
}
```

**ì¸ë±ìŠ¤**:
```javascript
db.user_suggestions.createIndex({ "file_id": 1 })
```

**ì‚¬ìš© ì˜ˆì‹œ**:
- "íŒŒì¼ ì—…ë¡œë“œ í›„ ìë™ìœ¼ë¡œ ì œì•ˆ í‘œì‹œ"
- "ì‚¬ìš©ìê°€ ì œì•ˆì„ í´ë¦­í•˜ë©´ í•´ë‹¹ ë¶„ì„ ì‹¤í–‰"

---

### 4ï¸âƒ£ `analysis_results` ì»¬ë ‰ì…˜ (ë¶„ì„ ê²°ê³¼)

**ëª©ì **: ìë™í™” íŒŒì´í”„ë¼ì¸ ì‹¤í–‰ ê²°ê³¼ ì €ì¥

**ìŠ¤í‚¤ë§ˆ**:
```json
{
  "_id": ObjectId("..."),
  "analysis_id": "analysis_20241229120000",   // ê³ ìœ  ë¶„ì„ ID
  "file_id": "file_20241229120000_user123",
  "user_id": "user123",
  "analysis_type": "auto_feature_engineering", // ë¶„ì„ ìœ í˜•
  "result": {
    "metrics": {                               // ëª¨ë¸ ì„±ëŠ¥ ì§€í‘œ
      "mae": 1.23,
      "rmse": 1.45,
      "r2": 0.65,
      "accuracy": 72.5
    },
    "feature_count": 18,                      // ìƒì„±ëœ í”¼ì²˜ ê°œìˆ˜
    "target_column": "ìˆ˜ëŸ‰",                  // ì˜ˆì¸¡ íƒ€ê²Ÿ
    "group_by": ["ìƒí’ˆëª…", "ì§€ì—­"],           // ê·¸ë£¹í™” ê¸°ì¤€
    "processing_time_seconds": 12.5           // ì²˜ë¦¬ ì‹œê°„
  },
  "created_at": ISODate("2024-12-29T12:00:00Z")
}
```

**ì¸ë±ìŠ¤**:
```javascript
// íŒŒì¼ë³„ ë¶„ì„ ê²°ê³¼ ì¡°íšŒ
db.analysis_results.createIndex({ "file_id": 1, "analysis_type": 1 })

// ì‚¬ìš©ìë³„ ìµœê·¼ ë¶„ì„ ê²°ê³¼
db.analysis_results.createIndex({ "user_id": 1, "created_at": -1 })
```

**ì‚¬ìš© ì˜ˆì‹œ**:
- "ì´ íŒŒì¼ì˜ ë¶„ì„ ê²°ê³¼ ë³´ê¸°"
- "ì‚¬ìš©ìì˜ ìµœê·¼ ë¶„ì„ ì´ë ¥"
- "ë¶„ì„ ì„±ëŠ¥ ë¹„êµ"

---

### 5ï¸âƒ£ `feature_weights` ì»¬ë ‰ì…˜ (í”¼ì²˜ ê°€ì¤‘ì¹˜)

**ëª©ì **: ê° í”¼ì²˜ì˜ ì¤‘ìš”ë„(ê°€ì¤‘ì¹˜) ì €ì¥

**ìŠ¤í‚¤ë§ˆ**:
```json
{
  "_id": ObjectId("..."),
  "weight_id": "weight_20241229120000",       // ê³ ìœ  ê°€ì¤‘ì¹˜ ID
  "file_id": "file_20241229120000_user123",
  "user_id": "user123",
  "weights": {                                 // í”¼ì²˜ë³„ ê°€ì¤‘ì¹˜
    "ìˆ˜ëŸ‰_lag_1": 0.25,                       // ì „ì¼ íŒë§¤ëŸ‰
    "ìˆ˜ëŸ‰_lag_7": 0.15,                       // 1ì£¼ ì „ íŒë§¤ëŸ‰
    "ìˆ˜ëŸ‰_MA3": 0.12,                         // 3ì¼ ì´ë™í‰ê· 
    "temp_max": 0.10,                         // ìµœê³  ê¸°ì˜¨
    "temp_min": 0.08,                         // ìµœì € ê¸°ì˜¨
    "rainfall": 0.07,                         // ê°•ìˆ˜ëŸ‰
    "spend": 0.09,                            // ê´‘ê³ ë¹„
    "clicks": 0.08,                           // í´ë¦­ìˆ˜
    "í‰ì ": 0.06                              // í‰ì 
  },
  "model_metrics": {                          // ëª¨ë¸ ì„±ëŠ¥
    "mae": 1.23,
    "rmse": 1.45,
    "r2": 0.65,
    "accuracy": 72.5
  },
  "feature_importance": {                     // ëª¨ë¸ì˜ í”¼ì²˜ ì¤‘ìš”ë„ (ì„ íƒì )
    "ìˆ˜ëŸ‰_lag_1": 0.28,
    "temp_max": 0.15,
    "spend": 0.12
  },
  "created_at": ISODate("2024-12-29T12:00:00Z")
}
```

**ì¸ë±ìŠ¤**:
```javascript
// íŒŒì¼ë³„ ê°€ì¤‘ì¹˜ ì¡°íšŒ
db.feature_weights.createIndex({ "file_id": 1 })

// ì‚¬ìš©ìë³„ ê°€ì¤‘ì¹˜ ì¡°íšŒ
db.feature_weights.createIndex({ "user_id": 1, "created_at": -1 })
```

**ì‚¬ìš© ì˜ˆì‹œ**:
- "ì´ íŒŒì¼ì—ì„œ ì–´ë–¤ í”¼ì²˜ê°€ ì¤‘ìš”í•œì§€ ë³´ê¸°"
- "ê°€ì¤‘ì¹˜ ê¸°ë°˜ ì˜ˆì¸¡ ëª¨ë¸ ìƒì„±"
- "í”¼ì²˜ ì¤‘ìš”ë„ ì‹œê°í™”"

---

## ğŸ”— ì»¬ë ‰ì…˜ ê°„ ê´€ê³„

```
files (1) â”€â”€â†’ (N) csv_contents
  â”‚
  â”œâ”€â”€â†’ (1) user_suggestions
  â”‚
  â”œâ”€â”€â†’ (N) analysis_results
  â”‚
  â””â”€â”€â†’ (N) feature_weights
```

**ê´€ê³„ ì„¤ëª…**:
- `files` 1ê°œ â†’ `csv_contents` Nê°œ (1:N)
- `files` 1ê°œ â†’ `user_suggestions` 1ê°œ (1:1)
- `files` 1ê°œ â†’ `analysis_results` Nê°œ (1:N, ì—¬ëŸ¬ ë²ˆ ë¶„ì„ ê°€ëŠ¥)
- `files` 1ê°œ â†’ `feature_weights` Nê°œ (1:N, ì—¬ëŸ¬ ëª¨ë¸ ê°€ëŠ¥)

---

## ğŸ“Š ë°ì´í„° íë¦„ ì˜ˆì‹œ

### ì‹œë‚˜ë¦¬ì˜¤: ì‚¬ìš©ìê°€ CSV ì—…ë¡œë“œ â†’ ë¶„ì„ ì‹¤í–‰

#### Step 1: íŒŒì¼ ì—…ë¡œë“œ
```javascript
// files ì»¬ë ‰ì…˜ì— ì €ì¥
{
  "file_id": "file_001",
  "user_id": "user123",
  "file_name": "sales.csv",
  "columns": ["ë‚ ì§œ", "ìƒí’ˆ", "ìˆ˜ëŸ‰", "ê¸ˆì•¡"],
  "row_count": 5000
}

// csv_contents ì»¬ë ‰ì…˜ì— 5000ê°œ ë¬¸ì„œ ì €ì¥
[
  { "file_id": "file_001", "row_index": 0, "data": {...} },
  { "file_id": "file_001", "row_index": 1, "data": {...} },
  ...
]
```

#### Step 2: ìë™ ì œì•ˆ ìƒì„±
```javascript
// user_suggestions ì»¬ë ‰ì…˜ì— ì €ì¥
{
  "file_id": "file_001",
  "suggestions": [
    "ğŸ’° 'ê¸ˆì•¡' ì»¬ëŸ¼ì´ ìˆë„¤ìš”! í•©ê³„ë¥¼ êµ¬í•´ë“œë¦´ê¹Œìš”?",
    "ğŸ“¦ 'ìˆ˜ëŸ‰' ì»¬ëŸ¼ì´ ìˆë„¤ìš”! ì´ íŒë§¤ëŸ‰ì„ ê³„ì‚°í•´ë“œë¦´ê¹Œìš”?"
  ]
}
```

#### Step 3: ë¶„ì„ ì‹¤í–‰
```javascript
// analysis_results ì»¬ë ‰ì…˜ì— ì €ì¥
{
  "analysis_id": "analysis_001",
  "file_id": "file_001",
  "result": {
    "metrics": { "accuracy": 72.5 }
  }
}

// feature_weights ì»¬ë ‰ì…˜ì— ì €ì¥
{
  "weight_id": "weight_001",
  "file_id": "file_001",
  "weights": {
    "ìˆ˜ëŸ‰_lag_1": 0.25,
    "ê¸ˆì•¡": 0.20
  }
}
```

---

## ğŸ” ì£¼ìš” ì¿¼ë¦¬ ì˜ˆì‹œ

### 1. ì‚¬ìš©ìì˜ ëª¨ë“  íŒŒì¼ ì¡°íšŒ
```javascript
db.files.find({ "user_id": "user123" })
  .sort({ "uploaded_at": -1 })
```

### 2. íŠ¹ì • íŒŒì¼ì˜ ë°ì´í„° ì¡°íšŒ (ì²« 100ê°œ)
```javascript
db.csv_contents.find({ "file_id": "file_001" })
  .sort({ "row_index": 1 })
  .limit(100)
```

### 3. íŒŒì¼ì˜ ìµœì‹  ë¶„ì„ ê²°ê³¼ ì¡°íšŒ
```javascript
db.analysis_results.find({ "file_id": "file_001" })
  .sort({ "created_at": -1 })
  .limit(1)
```

### 4. íŒŒì¼ì˜ ìµœì‹  ê°€ì¤‘ì¹˜ ì¡°íšŒ
```javascript
db.feature_weights.find({ "file_id": "file_001" })
  .sort({ "created_at": -1 })
  .limit(1)
```

### 5. ì œì•ˆ ì¡°íšŒ
```javascript
db.user_suggestions.findOne({ "file_id": "file_001" })
```

---

## âš ï¸ ê³ ë ¤ì‚¬í•­

### 1. ë°ì´í„° í¬ê¸°
- `csv_contents`ëŠ” ëŒ€ëŸ‰ ë°ì´í„°ì´ë¯€ë¡œ:
  - ë°°ì¹˜ ì‚½ì… ì‚¬ìš© (1000ê°œì”©)
  - í•„ìš”ì‹œ ìƒ¤ë”© ê³ ë ¤
  - ì˜¤ë˜ëœ ë°ì´í„°ëŠ” ì•„ì¹´ì´ë¹™

### 2. ì¸ë±ìŠ¤ ê´€ë¦¬
- ìì£¼ ì¡°íšŒí•˜ëŠ” í•„ë“œì— ì¸ë±ìŠ¤ ìƒì„±
- ì¸ë±ìŠ¤ê°€ ë„ˆë¬´ ë§ìœ¼ë©´ ì“°ê¸° ì„±ëŠ¥ ì €í•˜

### 3. ë°ì´í„° ì¼ê´€ì„±
- `file_id`ëŠ” ëª¨ë“  ì»¬ë ‰ì…˜ì—ì„œ ì¼ê´€ë˜ê²Œ ì‚¬ìš©
- íŒŒì¼ ì‚­ì œ ì‹œ ê´€ë ¨ ë°ì´í„°ë„ í•¨ê»˜ ì‚­ì œ (CASCADE)

### 4. ë³´ì•ˆ
- `user_id`ë¡œ ë°ì´í„° ê²©ë¦¬
- ë¯¼ê°í•œ ë°ì´í„°ëŠ” ì•”í˜¸í™” ê³ ë ¤

---

## ğŸ“ˆ í™•ì¥ ê°€ëŠ¥ì„±

### í–¥í›„ ì¶”ê°€ ê°€ëŠ¥í•œ ì»¬ë ‰ì…˜:
1. `model_versions` - ëª¨ë¸ ë²„ì „ ê´€ë¦¬
2. `predictions` - ì˜ˆì¸¡ ê²°ê³¼ ì €ì¥
3. `user_preferences` - ì‚¬ìš©ì ì„¤ì •
4. `analysis_history` - ë¶„ì„ ì´ë ¥

---

*ë¬¸ì„œ ì‘ì„±ì¼: 2024-12-29*

